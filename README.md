# A survey on computational methods for MSI experiments
*by Dan Guo, on 11/15/2021*

## 1. What is Mass Spectrometry Imaging

Mass Spectrometry Imaging (MSI) is a technique that detects spatially-resolved molecular compositions of samples, such as tissues. It collects mass spectra at thousands of locations in a raster pattern throughout a sample. A mass spectrum is a plot with *x-axis* as the mass-over-charge ratio (*m/z*) of ionized molecules and *y-axis* as their corresponding intensities. A location is referred to as a *pixel*, and unlike natural images, a pixel in MSI is not represented by RGB values but a mass spectrum instead. The plot of the intensities of a specific m/z across pixels is called an *ion image*.

## 2. Computational goals in MSI

The computational goals in MSI can be divided into three categories: pixel segmentation, m/z clustering, and image classification.
- *Pixel segmentation*, segmenting pixels into segments of homogeneous molecular compositions using a single or multiple m/z.
- *m/z clustering*, clustering m/z into spatially-similar groups according to their ion images
- *image classification*, classifying MSI into different classes, such as delineation of tumor tissues.

## 3. Pixel segmentation

### Multivariate segmentation

***Multivariate segmentation*** uses multiple m/z as features for segmentation, which was first brought into MSI experiment analysis. Some general methods are:

- Principal component analysis (PCA)
- Non-maximum factorization (NMF)
- T-sne 
- UMAP

Some methods were developed specifically for MSI segmentation:

- [Spatial K-means segmentation](https://academic.oup.com/bioinformatics/article/27/13/i230/183028) (Theodore *et al*., 2012)
- [Spatial shrunken centroids segmentation](https://www.mcponline.org/article/S1535-9476(20)33611-2/fulltext) (Bemis *et al*., 2016 )
- [Two-phase k-means and two-phase graph cuts](https://pubs.acs.org/doi/pdf/10.1021/acs.analchem.7b01758) (Dexter *et al*., 2017) attempts to reduce memory complexity by applying k-means or spectral clustering on a compressed dataset, which is obtained by adding the centers of k-means applied on a subset of pixels.


### Univariate segmentation


### Combining multivariate and univariate segmentation

[Spatial Segmentation of Mass Spectrometry Imaging Data by Combining Multivariate Clustering and Univariate Thresholding](https://pubs.acs.org/doi/pdf/10.1021/acs.analchem.0c04798) (Hu *et al*., 2021). This method combined segments generated by PCA or UMAP followed by GMM and univariate thresholding. 

### Segmentation combined with other image modalities 

[Towards More Reliable Unsupervised Tissue Segmentation Via Integrating Mass Spectrometry Imaging and Hematoxylin-Erosin Stained Histopathological Image](https://www.biorxiv.org/content/biorxiv/early/2020/07/17/2020.07.17.208025.full.pdf) (Guo *et al*., 2020). It upsamples MSI, then coregistration it and H&E stained image. It stacks the m/z features and morphological features of H&E image together as inputs of the segmentation algorithm.

### Evaluation of segmentation

[Testing for Multivariate Normality in Mass Spectrometry Imaging Data: A Robust Statistical Approach for Clustering Evaluation and the Generation of Synthetic Mass Spectrometry Imaging Data Sets](https://pubs.acs.org/doi/pdf/10.1021/acs.analchem.6b02139) (Dexter *et al*., 2016)

It may not be a good evaluation for methods that incorporate spatial dependences. 
